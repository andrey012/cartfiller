<!DOCTYPE html>
<html>
    <head>

    </head>
    <body>
        <a href="#" onclick="window.parent.postMessage('cartFillerMessage:' + JSON.stringify({cmd: 'jobDetails', details: [{task: 'clearCart'}, {task: 'submit'}, {task: 'submit'}, {task: 'addToCart', partno: '30793231', quantity: 2}, {task: 'addToCart', partno: '30748811', quantity: 3}, {task: 'addToCart', partno: '30793231', quantity: 2}, {task: 'addToCart', partno: '30748811', quantity: 3}, {task: 'addToCart', partno: '30793231', quantity: 2}, {task: 'addToCart', partno: '30748811', quantity: 3}, {task: 'addToCart', partno: '30793231', quantity: 2}, {task: 'addToCart', partno: '30748811', quantity: 3}], titleMap: {clearCart: 'Очистить корзину', addToCart: 'Добавить в корзину', partno: 'Каталожный номер', quantity: 'Количество'}, workerSrc: 'http://localhost/cartfiller/samples/worker.js', resultMessage: 'sampleResultMessage'}), '*');">submit</a>
        <div id="result">

        </div>
        <script>
            window.addEventListener("message", function(event){
                var data = /^sampleResultMessage:(.*)$/.exec(event.data);
                if (data) {
                    var msg = JSON.parse(data[1]);
                    for (var i = 0; i < msg.tasks.length; i++){
                        if (msg.tasks[i].task === 'addToCart'){
                            if (true !== msg.result[i].complete) {
                                jQuery('#operationItem_' + tasks[i].id + ':not(:checked)').click();
                            }
                        }
                    }
                }
            },false);
        </script>
    </body>
</html>